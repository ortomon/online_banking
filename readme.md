Проект онлайн банк

1 Этап - создание пользователя.
ВНИМАНИЕ:
-За хранение данных должны отвечать репозитории, а не сервисы!
-Вы можете создавать свои классы для облегчения себе жизни. Но класс должен решать реальную проблему (например хранение нескольких полей в одной сущности), а не просто захламлять приложение.

1. Создать web приложение используя spring-boot(зависимости по вашему желанию).
2. Добавить плагин чекстайла и проверить его работоспособность на этапе сборки.
3. Создать сущность пользователь - хранит в себе телефон, уникальный идентификатор(класс java.util.UUID), фио владельца.
4. Создать репозиторий для пользователя.
5. Создать сервис работы с пользователем. Методы сервиса:
   5.1. Регистрация пользователя: передается телефон, фио владельца. Возврашает случайный пинкод из 4 цифр (ТЕКСТ! "0001").
   5.1.0. Проверяет что пользователя с таким телефоном нет, иначе ошибка.
   5.1.1. Создает пользователя с телефоном, фио, случайно сгенерированным UUID (UUID.randomUUID()). Генерируется случайный пинкод.
   5.1.2. Заносится в сервис аутентификации новая запись (6.1)
   5.1.3. Возвращает сгенерированный пинкод.
   5.1.4. Созданный пользователь хранится в репозитории для пользователей.
   5.2 Аутентификация пользователя: передается телефон и пинкод. Возвращается сгенерированный токен.
   5.2.1 Необходимо найти пользователя по телефону.
   5.2.2 Из пользователя достать уникальный идентификатор.
   5.2.3 Вызвать метод 6.2, если вернет false, то значит некорректный пинкод. Завершить метод ошибкой.
   5.2.4 Если ошибок нет, сгенерировать токен и вернуть его. Формат токена:
   "online[уникальный идентификатор пользователя]token"
   Пример для пользователя с идентификатором 'aaa-aaa-aaa-aaaa':
   onlineaaa-aaa-aaa-aaaatoken
   5.3 Нахождение пользователя по токену (на вход токен):
   5.3.1 Вытаскиваем из токена пользователя уникальный идентификатор
   5.3.2 Возвращаем пользователя, если пользователь с таким идентификатором существует, иначе выбрасываем ошибку.

6. Для аутентификации пользователей нам потребуется сервис аутентификации. Аутентификация - проверка для входа в приложение пользователем, например ввод логина и пароля на сайте является аутентификацией. Сервис будет содержать в себе пары - уникальный индентификатор пользователя - пинкод.
   6.1 У сервиса аутентификации есть метод - добавить новую запись. Добавляется пара уникальный индентификатор + пинкод (число из 4 цифр).
   6.2 У сервиса аутентификации есть метод - аутентификация: на вход передается уникальный индентификатор, пинкод. На выход передается результат проверки: есть запись с таким уникальным индентификатором и пинкод по этому идентификатору совпадает с переданным пинкодом.
   Пример:
   В сервис добавили запись: 'aaa-aaa-aaa-aaaa': 1234.
   Вызывают метод аутентификация с параметрами: 'aaa-aaa-aaa-aaaa', 5552. Сервис вернет false, так как по данному уникальному идентификатору пинкод 1234. 1234 не равен 5552.
   Вызывают метод аутентификация с параметрами: 'aaa-aaa-aaa-aaaa', 1234. Сервис вернет true, так как по данному уникальному идентификатору хранится пинкод 1234.

2 Этап - создание счетов
1. Создать сущность счет - номер счета (уникален), владелец (класс Пользователь этап1 пункт3), остаток на счете (с копейками).
2. Создать репозиторий для счетов. У репозитория должны быть методы: добавление счета, поиск счета по номеру, получение всех счетов у пользователя.
2. Создать сервис по работе со счетами. Методы сервиса:
   2.1 Создать метод генерации номера счета. На выход сгенерированная строка:
   "[6 цифр]". Например: "000001".
   Номера счетов уникальны (не могут повторяться).
   2.2. Создать счет для пользователя - на вход  пользователь:  создается счет с остатком 0.00. Номер счета берется из пункта 2.1
   2.3. Занести деньги на счет (номер счета, сумма). увеличивает остаток счета. Если счета не существует - ошибка.
   2.4. Списать деньги со счета (номер счета, сумма). Уменьшает остаток счета. Остаток после операции не может быть отрицательный. Если счета не существует - ошибка.
   2.5. Получить счета пользователя (на вход пользователь), на выход список его счетов.
   2.6. Получить остаток по счету(номер счета). На выход остаток. Если счета не существует - ошибка.
   2.7. Проверка принадлежности счета к пользователю. На вход пользователь и номер счета. Возвращает принадлежит или нет.

3 Этап - создание операций
1. Создать сущность операция - уникальный идентификатор, дата+время (равна времени создания операции), номер счета, тип операции (списание/зачисление), сумма, описание. Операции должны сохранятся в приложении.
2. Создать сервис операций. Умеет:
   2.1 Показывать все операции по счету. Порядок операций по дате (сначала новые, потом более старые).
   2.2. Заносить новую операцию.
   2.3 Показывать все операции для пользователя. На вход пользователь. Получаем счета пользователя (этап2 пункт 2.5), ищем по этим счетам операции.  Порядок операций по дате (сначала новые, потом более старые).
3. Создать Банк сервис. Сервис умеет:
   3.1. Делать платеж: на вход - номер счета, сумма, описание, токен. На основании токена получаем пользователя. Проверяем что счет принадлежит пользователю(этап 2 пункт2.7): если счет не принадлежит пользователю, выкидываем ошибку. Производит списание со счета (2 этап 2.4 пункт). Записывает операцию в историю.
   3.2. Показывать всю историю платежей по пользователю: на вход токен. На выход история операция по всем счетам пользователя в отсортированной по дате. По токену получить пользователя, дальше пункт 2.3.
   3.3. Делать засчисление: на вход - номер счета, сумма, описание. Зачисляет на счет деньги и записывает операцию в историю.

4 Этап - создание слоя контроллеров
1. Создать контроллер для работы с пользователями:
   1.1. Сделать endpoint POST /user/signup. В тело запроса положить телефон, фио владельца. Создаст пользователя. Вернет пинкод.
   1.2. Сделать endpoint POST /user/auth. В тело передается телефон и пинкод. Возвращается токен.
2. Создать контроллер для финансовых операций:
   2.1 Сделать endpoint GET /operations?token=[токен пользователя] - вернет список операций для пользователя.
   2.2 Сделать endpoint POST /operations/pay. В тело запроса положить токен, сумму операции, номер счета, описание операции. Делает платеж по пользовательскому счету.
   2.3 Сделать endpoint POST /operations/receive. В тело запроса положить сумму операции, номер счета, описание операции. Делает зачисление по этому счету.
3. Создать контроллер по счету:
   3.1 Сделать endpoint GET /account?token=[токен пользователя] - вернет списоск счетов у пользователя.
   3.2 Сделать endpoint GET /account/{номер счета} - вернет остаток по номеру счета.
   3.3 Сделать endpoint POST /account. В теле запроса - токен пользователя. Создает счет для пользователя. Возвращает номер созданного счета.
4. Добавить обработку ошибок сервера. Если произошла ошибка, то возвращаем текст: У нас произошла ошибка, уже работаем над ней. Никаких stackrace ошибок быть не должно.
5. Создать интеграционные тесты, обращаясь к сервису через http запросы.

5 этап - создание интеграции с другими банками.
1. Создать свойства для профиля moneybank. Cвойства этого профиля:
   -bank.name: LLC Moneybank
   -bank.partner.url: http://localhost:8001
   -Порт приложения 8082
2. Создать свойства для профиля eurobank. Cвойства этого профиля:
   -bank.name: LLC Eurobank
   -Порт приложения 8001
   -bank.partner.url: http://localhost:8082
3. Создать контроллер по банку:
   3.1. Сделать endpoint GET /bank-info. Должна вернуться информация: имя банка.
4. Создать сервис "Переводы в другие банки". В данном сервисе будет происходить интеграция с другими банками.  
   4.1 Создать метод перевод в другой банк, на вход - имя банка, сумма, описание, фио от кого пришло.
   4.1.1 Метод отправит POST запрос по адресу - bank.partner.url + /operations/receive.
5. Добавить в банк сервис  (этап3 пункт3) метод "перевод в другой банк". На вход токен пользователя, сумма, описание, счет с которого списание будет.
   5.1. Сделать перевод в другой банк (пункт 4.1).
   5.2. Списать деньги со счета, проверив что пользователь является владельцем счета.

6 Этап - добавить сваггер описание проекта

Доп этап если ВСЕ сделано
Создание валютного отдела и валюты у счетов
1. Добавить к счетам валюту. В банке могут быть открыты счета в 3 валютах (Рубль, Юань, Доллар).
   1.1. При генерации счетов добавляется в начале код валюты: рубль - 810, юань - 378, доллар 840.
   Например:
   было "000001"
   Стало: "810000001"

2. Создать сервис по работе с валютой. Имеет следующие методы:
   2.1 Создать обменный курс (на вход валюта1, валюта2, курс за одну единицу (число с пятью знаками после запятой)). Создать запись обменного курса для двух валют. Курс не может быть равен нулю или отрицательным.
   Пример: доллар рубль 90. Т.е за 1 доллар получим 90 рублей.
   2.2. Найти курс (на вход валюта1, валюта2). Ищем по курсам где эти две валюты совпадают. Если оказывается что есть только перевернутый курс, то считаем его по формуле 1 / на курс.
   Например:
   у нас есть курс доллар - рубль = 90. В метод "найти курс" передали - рубль, доллар. У нас нет валютной пары рубль - доллар, но есть доллар - рубль. Соответственно, мы вернем курс 1 / 90 = 0,01111.
   2.3. Произвести конвертацию (на вход сумма, валюта из которой делаем конвертацию, валюта в которую делаем конвертацию). На выход сумма купленной валюты. Используй пункт 1.2. Сумма не может быть нулевой или отрицательной.
3. Добавить в историю операции - валюту.
4. Добавить в банк сервис метод купить валюту: на вход счет1, счет2, сумма, токен. Производит списание суммы со счета1, делает конвертацию в валюту счета2. Проверяет, что счета принадлежат пользователю (получить счет на основании токена).
5. Ко всем операциям банк сервиса добавить валюту. В случае если валюта зачисления/списания будет отличаться от валюты счета, то делать конвертацию валют.
6. Написать интеграционные тесты на валютный отдел.
